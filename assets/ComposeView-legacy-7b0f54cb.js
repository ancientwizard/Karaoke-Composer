System.register(["./index-legacy-1803f8de.js","./audioStorageService-legacy-297a1f4c.js","./lyricsParser-legacy-fd32a37b.js"],function(e,a){"use strict";var t,l,o,s,r,n,i,c,d,u,b,m,p,v,f,g,h,y,x,k,w,C,j,S,F,B,T,D,M;return{setters:[e=>{t=e.d,l=e.r,o=e.c,s=e.a,r=e.b,n=e.t,i=e.F,c=e.e,d=e.w,u=e.v,b=e.f,m=e.g,p=e.h,v=e.i,f=e.n,g=e.j,h=e.o,y=e._,x=e.k,k=e.l,w=e.m,C=e.p,j=e.q,S=e.s,F=e.u,B=e.x,T=e.y},e=>{D=e.a},e=>{M=e.p}],execute:function(){var a=document.createElement("style");a.textContent=".modal.show[data-v-3a56e8f4]{background-color:rgba(0,0,0,.5)}.modal.show[data-v-6032be75]{display:block;background-color:rgba(0,0,0,.5)}.compose-header[data-v-6032be75]{border-radius:.5rem;border:1px solid #dee2e6}.project-info[data-v-6032be75]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff}.project-info .card-body[data-v-6032be75]{background:rgba(255,255,255,.1);backdrop-filter:blur(10px);border-radius:.5rem}.projects-screen[data-v-6032be75]{min-height:60vh}.project-item[data-v-6032be75]{border-left:3px solid transparent;transition:all .2s ease}.project-item[data-v-6032be75]:hover{border-left-color:#0d6efd;transform:translate(2px)}.project-content-btn[data-v-6032be75]{padding:1rem;height:auto;white-space:normal;text-align:left!important;display:flex;flex-direction:column;align-items:flex-start;flex:1}.project-content-btn[data-v-6032be75]:hover{background-color:#f8f9fa;border-color:#0d6efd;color:#212529!important}.project-content-btn:hover .text-muted[data-v-6032be75]{color:#6c757d!important}.project-content-btn:hover .text-primary[data-v-6032be75]{color:#0d6efd!important}.delete-btn[data-v-6032be75]{width:60px;max-width:60px;flex:0 0 60px;display:flex;align-items:center;justify-content:center;font-size:1.5rem}.export-btn[data-v-6032be75]{width:60px;max-width:60px;flex:0 0 60px;display:flex;align-items:center;justify-content:center;font-size:1.3rem}.export-btn[data-v-6032be75]:hover{background-color:#198754!important;border-color:#198754!important}.project-item .btn-group[data-v-6032be75]{transition:all .2s ease}.btn-group>.btn[data-v-6032be75]:not(:last-child){border-right:none}.btn-group>.btn[data-v-6032be75]:not(:first-child){border-left:none}.developer-toolbar[data-v-6032be75]{position:fixed;bottom:0;left:0;right:0;background:#f8f9fa;border-top:2px solid #007bff;box-shadow:0 -2px 10px rgba(0,0,0,.1);z-index:1000}.toolbar-header[data-v-6032be75]{display:flex;align-items:center;justify-content:space-between;padding:8px 0;cursor:pointer;user-select:none;transition:background-color .2s}.toolbar-header[data-v-6032be75]:hover{background-color:rgba(0,0,0,.02)}.toolbar-label[data-v-6032be75]{display:flex;align-items:center}.toolbar-toggle[data-v-6032be75]{color:#6c757d;transition:transform .3s ease}.toolbar-toggle .rotate-180[data-v-6032be75]{transform:rotate(180deg)}.toolbar-content[data-v-6032be75]{padding-bottom:10px;border-top:1px solid #dee2e6;padding-top:10px}.toolbar-buttons[data-v-6032be75]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.compose-view[data-v-6032be75]{padding-bottom:60px}\n",document.head.appendChild(a);class E{static toLRC(e){const a=[];a.push("[version:2.1]"),a.push("[syllable_timing:true]"),e.name&&a.push(`[ti:${this.escapeMetadata(e.name)}]`),e.artist&&a.push(`[au:${this.escapeMetadata(e.artist)}]`),a.push("[creator:Karaoke Composer]");const t=this.calculateDuration(e.lyrics);t>0&&a.push(`[duration:${this.formatTimestamp(t)}]`),a.push("");let l=0;for(const o of e.lyrics){if(o.type&&"lyrics"!==o.type&&"caption"!==o.type)continue;if("caption"===o.type){const e=o.metadata?.caption||o.text.replace(/^\[@CAPTION:\s*/,"").replace(/\]$/,"");a.push(`#[line:${l}:caption:${this.escapeMetadata(e)}]`);continue}if(!o.words||0===o.words.length)continue;const e=o.words[0].startTime||0,t=this.formatLine(o);a.push(`[${this.formatTimestamp(e)}]${t}`),l++}return a.join("\n")+"\n"}static formatLine(e){if(!e.words)return e.text;const a=[];for(const t of e.words){if(t.syllables&&0!==t.syllables.length)for(const e of t.syllables)void 0!==e.startTime?a.push(`<${this.formatTimestamp(e.startTime)}>${e.syllable}`):a.push(e.syllable);else void 0!==t.startTime?a.push(`<${this.formatTimestamp(t.startTime)}>${t.word}`):a.push(t.word);a.push(" ")}return a.join("").trim()}static formatTimestamp(e){const a=e/1e3,t=Math.floor(a/60),l=a%60;return`${String(t).padStart(2,"0")}:${l.toFixed(2).padStart(5,"0")}`}static escapeMetadata(e){return e.replace(/[\r\n]/g," ").replace(/[[\]]/g,"")}static calculateDuration(e){let a=0;for(const t of e)if(t.words)for(const e of t.words)void 0!==e.endTime&&e.endTime>a&&(a=e.endTime);return a}}const U={class:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"},$={class:"modal-content"},L={class:"modal-body"},I={class:"alert alert-info"},P={class:"mb-1"},A={class:"mb-2 text-muted"},R={class:"d-flex gap-3 small"},V={class:"nav nav-tabs mb-3",role:"tablist"},O=["onClick"],q={class:"me-2"},N={class:"tab-content"},_={key:0,class:"tab-pane fade show active"},z={class:"card mb-3"},G={class:"card-body"},J={class:"form-check mb-2"},W={class:"form-check mb-2"},H={class:"form-check mb-2"},K={class:"row align-items-center mb-2"},Y={class:"col-sm-8"},Q={class:"card mb-3"},X={class:"card-body"},Z={class:"bg-dark text-light p-3 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},ee=["disabled"],ae={key:0},te={key:1},le={key:1,class:"tab-pane fade show active"},oe={class:"card mb-3"},se={class:"card-body"},re={class:"row align-items-center mb-2"},ne={class:"col-sm-8"},ie={class:"row align-items-center mb-2"},ce={class:"col-sm-8"},de={class:"row align-items-center mb-2"},ue={class:"col-sm-8"},be={class:"form-check mb-2"},me={class:"form-check mb-2"},pe={class:"form-check mb-2"},ve={key:0,class:"row align-items-center mb-2 ms-4"},fe={class:"col-sm-7"},ge={class:"card mb-3"},he={class:"card-body"},ye={class:"mb-1"},xe=["disabled"],ke={key:0},we={key:1},Ce={key:2,class:"tab-pane fade show active"},je={class:"card mb-3"},Se={class:"card-body"},Fe={class:"form-check mb-2"},Be={class:"form-check mb-2"},Te={class:"form-check mb-2"},De={class:"card mb-3"},Me={class:"card-body"},Ee={class:"mb-1"},Ue={class:"mb-1"},$e={class:"mb-1"},Le={class:"mb-0"},Ie=["disabled"],Pe={key:0},Ae={key:1},Re=y(t({__name:"ExportDialog",props:{project:{}},emits:["close"],setup(e,{emit:a}){const t=e,y=a,x=l("lrc"),k=l({includeMetadata:!0,includeSyllables:!0,includeWordTiming:!0,precision:2}),w=l({backgroundColor:"#000080",textColor:"#FFFFFF",highlightColor:"#FFFF00",showBorder:!0,centerText:!0,showMetadata:!0,metadataDuration:3,showCaptions:!0,captionDuration:2}),C=l({prettyPrint:!0,includeMetadata:!0,includeStats:!0}),j=l(!1),S=l(null),F=[{id:"lrc",label:"LRC",icon:"📄"},{id:"cdg",label:"CDG",icon:"💿"},{id:"json",label:"JSON",icon:"💾"}],B=o(()=>function(e){let a=0,t=0,l=0,o=0;const s=e.lyrics.filter(e=>void 0!==e.startTime).length;for(const i of e.lyrics)for(const e of i.words){a++,void 0!==e.startTime&&l++;for(const a of e.syllables)t++,void 0!==a.startTime&&o++}const r=e.audioFile.duration||0,n=t>0?Math.round(o/t*100):0;return{totalLines:e.lyrics.length,totalWords:a,totalSyllables:t,timedLines:s,timedWords:l,timedSyllables:o,duration:r,completionPercentage:n}}(t.project)),T=o(()=>{try{const e=E.toLRC(t.project).split("\n");return e.slice(0,10).join("\n")+(e.length>10?"\n...":"")}catch{return"Preview not available"}}),D=o(()=>{const e=B.value.duration,a=24*Math.ceil(75*e);return Math.ceil(a/1024)}),M=o(()=>{const e=JSON.stringify(t.project);return Math.ceil(e.length/1024)});function Re(){y("close")}async function Ve(){j.value=!0;try{const e=E.toLRC(t.project),a=new Blob([e],{type:"text/plain;charset=utf-8"}),l=URL.createObjectURL(a),o=document.createElement("a");o.href=l,o.download=`${t.project.name.toLowerCase().replace(/\s+/g,"_")}.lrc`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(l),Ne("success","✅ LRC file exported successfully!")}catch(e){Ne("error",`❌ Export failed: ${e.message}`)}finally{j.value=!1}}async function Oe(){j.value=!0;try{Ne("error","❌ CDG export requires Node.js environment. Use the CLI tool: npx tsx src/karaoke/demo/generateCDG.ts")}catch(e){Ne("error",`❌ Export failed: ${e.message}`)}finally{j.value=!1}}async function qe(){j.value=!0;try{const e=C.value.prettyPrint?JSON.stringify(t.project,null,2):JSON.stringify(t.project),a=new Blob([e],{type:"application/json"}),l=URL.createObjectURL(a),o=document.createElement("a");o.href=l,o.download=`${t.project.name.toLowerCase().replace(/\s+/g,"_")}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(l),Ne("success","✅ JSON file exported successfully!")}catch(e){Ne("error",`❌ Export failed: ${e.message}`)}finally{j.value=!1}}function Ne(e,a){S.value={type:e,message:a},setTimeout(()=>{S.value=null},4e3)}return(a,t)=>{return h(),s("div",{class:"modal show d-block",tabindex:"-1",onClick:g(Re,["self"])},[r("div",U,[r("div",$,[r("div",{class:"modal-header"},[t[14]||(t[14]=r("h5",{class:"modal-title"},"📤 Export Project",-1)),r("button",{type:"button",class:"btn-close",onClick:Re,"aria-label":"Close"})]),r("div",L,[r("div",I,[r("h5",P,n(e.project.name),1),r("p",A,[r("em",null,"by "+n(e.project.artist),1)]),r("div",R,[r("span",null,n(B.value.timedSyllables)+" syllables",1),t[15]||(t[15]=r("span",null,"•",-1)),r("span",null,n((l=B.value.duration,`${Math.floor(l/60)}:${Math.floor(l%60).toString().padStart(2,"0")}`)),1),t[16]||(t[16]=r("span",null,"•",-1)),r("span",null,n(B.value.completionPercentage)+"% complete",1)])]),r("ul",V,[(h(),s(i,null,c(F,e=>r("li",{class:"nav-item",key:e.id},[r("button",{class:f(["nav-link",{active:x.value===e.id}]),onClick:a=>x.value=e.id,type:"button"},[r("span",q,n(e.icon),1),v(" "+n(e.label),1)],10,O)])),64))]),r("div",N,["lrc"===x.value?(h(),s("div",_,[t[24]||(t[24]=r("h5",null,"LRC V2.1 Export",-1)),t[25]||(t[25]=r("p",{class:"text-muted"}," Export as Enhanced LRC format with syllable-level timing. Compatible with modern karaoke players. ",-1)),r("div",z,[t[22]||(t[22]=r("div",{class:"card-header"},[r("strong",null,"Settings")],-1)),r("div",G,[r("div",J,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>k.value.includeMetadata=e),id:"lrcMetadata"},null,512),[[u,k.value.includeMetadata]]),t[17]||(t[17]=r("label",{class:"form-check-label",for:"lrcMetadata"}," Include metadata (title, artist, album) ",-1))]),r("div",W,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>k.value.includeSyllables=e),id:"lrcSyllables"},null,512),[[u,k.value.includeSyllables]]),t[18]||(t[18]=r("label",{class:"form-check-label",for:"lrcSyllables"}," Include syllable timing (V2.1 format) ",-1))]),r("div",H,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>k.value.includeWordTiming=e),id:"lrcWordTiming"},null,512),[[u,k.value.includeWordTiming]]),t[19]||(t[19]=r("label",{class:"form-check-label",for:"lrcWordTiming"}," Include word timing markers ",-1))]),r("div",K,[t[21]||(t[21]=r("label",{class:"col-sm-4 col-form-label"},"Timestamp precision:",-1)),r("div",Y,[d(r("select",{class:"form-select","onUpdate:modelValue":t[3]||(t[3]=e=>k.value.precision=e)},[...t[20]||(t[20]=[r("option",{value:"2"},"Centisecond (00.00)",-1),r("option",{value:"3"},"Millisecond (00.000)",-1)])],512),[[b,k.value.precision]])])])])]),r("div",Q,[t[23]||(t[23]=r("div",{class:"card-header"},[r("strong",null,"Preview")],-1)),r("div",X,[r("pre",Z,n(T.value),1)])]),r("button",{class:"btn btn-primary w-100",onClick:Ve,disabled:j.value},[j.value?(h(),s("span",te,"⏳ Exporting...")):(h(),s("span",ae,"📄 Export LRC File"))],8,ee)])):m("",!0),"cdg"===x.value?(h(),s("div",le,[t[39]||(t[39]=r("h5",null,"CDG Export",-1)),t[40]||(t[40]=r("p",{class:"text-muted"}," Export as CD+G format for professional karaoke machines. Creates binary .cdg file with graphics data. ",-1)),r("div",oe,[t[33]||(t[33]=r("div",{class:"card-header"},[r("strong",null,"Settings")],-1)),r("div",se,[r("div",re,[t[26]||(t[26]=r("label",{class:"col-sm-4 col-form-label"},"Background color:",-1)),r("div",ne,[d(r("input",{type:"color",class:"form-control form-control-color","onUpdate:modelValue":t[4]||(t[4]=e=>w.value.backgroundColor=e)},null,512),[[p,w.value.backgroundColor]])])]),r("div",ie,[t[27]||(t[27]=r("label",{class:"col-sm-4 col-form-label"},"Text color:",-1)),r("div",ce,[d(r("input",{type:"color",class:"form-control form-control-color","onUpdate:modelValue":t[5]||(t[5]=e=>w.value.textColor=e)},null,512),[[p,w.value.textColor]])])]),r("div",de,[t[28]||(t[28]=r("label",{class:"col-sm-4 col-form-label"},"Highlight color:",-1)),r("div",ue,[d(r("input",{type:"color",class:"form-control form-control-color","onUpdate:modelValue":t[6]||(t[6]=e=>w.value.highlightColor=e)},null,512),[[p,w.value.highlightColor]])])]),r("div",be,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=e=>w.value.showBorder=e),id:"cdgBorder"},null,512),[[u,w.value.showBorder]]),t[29]||(t[29]=r("label",{class:"form-check-label",for:"cdgBorder"}," Show decorative border ",-1))]),r("div",me,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>w.value.centerText=e),id:"cdgCenter"},null,512),[[u,w.value.centerText]]),t[30]||(t[30]=r("label",{class:"form-check-label",for:"cdgCenter"}," Center text on screen ",-1))]),r("div",pe,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>w.value.showCaptions=e),id:"cdgCaptions"},null,512),[[u,w.value.showCaptions]]),t[31]||(t[31]=r("label",{class:"form-check-label",for:"cdgCaptions"},' Show captions (e.g., "Verse 1", "Chorus") ',-1))]),w.value.showCaptions?(h(),s("div",ve,[t[32]||(t[32]=r("label",{class:"col-sm-5 col-form-label small"},"Caption duration (seconds):",-1)),r("div",fe,[d(r("input",{type:"number",class:"form-control form-control-sm","onUpdate:modelValue":t[10]||(t[10]=e=>w.value.captionDuration=e),min:"1",max:"10",step:"0.5"},null,512),[[p,w.value.captionDuration,void 0,{number:!0}]])])])):m("",!0)])]),r("div",ge,[t[38]||(t[38]=r("div",{class:"card-header"},[r("strong",null,"File Information")],-1)),r("div",he,[t[35]||(t[35]=r("p",{class:"mb-1"},[r("strong",null,"Format:"),v(" CD+G Binary")],-1)),r("p",ye,[t[34]||(t[34]=r("strong",null,"Estimated size:",-1)),v(" "+n(D.value)+" KB",1)]),t[36]||(t[36]=r("p",{class:"mb-1"},[r("strong",null,"Resolution:"),v(" 288×192 pixels (6-bit color)")],-1)),t[37]||(t[37]=r("p",{class:"mb-0"},[r("strong",null,"Packet rate:"),v(" 75 packets/second")],-1))])]),r("button",{class:"btn btn-primary w-100",onClick:Oe,disabled:j.value},[j.value?(h(),s("span",we,"⏳ Exporting...")):(h(),s("span",ke,"💿 Export CDG File"))],8,xe)])):m("",!0),"json"===x.value?(h(),s("div",Ce,[t[50]||(t[50]=r("h5",null,"JSON Export",-1)),t[51]||(t[51]=r("p",{class:"text-muted"}," Export complete project data as JSON for backup, sharing, or programmatic use. ",-1)),r("div",je,[t[44]||(t[44]=r("div",{class:"card-header"},[r("strong",null,"Settings")],-1)),r("div",Se,[r("div",Fe,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=e=>C.value.prettyPrint=e),id:"jsonPretty"},null,512),[[u,C.value.prettyPrint]]),t[41]||(t[41]=r("label",{class:"form-check-label",for:"jsonPretty"}," Pretty print (formatted, readable) ",-1))]),r("div",Be,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=e=>C.value.includeMetadata=e),id:"jsonMetadata"},null,512),[[u,C.value.includeMetadata]]),t[42]||(t[42]=r("label",{class:"form-check-label",for:"jsonMetadata"}," Include project metadata ",-1))]),r("div",Te,[d(r("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=e=>C.value.includeStats=e),id:"jsonStats"},null,512),[[u,C.value.includeStats]]),t[43]||(t[43]=r("label",{class:"form-check-label",for:"jsonStats"}," Include statistics ",-1))])])]),r("div",De,[t[49]||(t[49]=r("div",{class:"card-header"},[r("strong",null,"📊 Export Info")],-1)),r("div",Me,[r("p",Ee,[t[45]||(t[45]=r("strong",null,"Lines:",-1)),v(" "+n(B.value.totalLines),1)]),r("p",Ue,[t[46]||(t[46]=r("strong",null,"Words:",-1)),v(" "+n(B.value.totalWords),1)]),r("p",$e,[t[47]||(t[47]=r("strong",null,"Syllables:",-1)),v(" "+n(B.value.totalSyllables),1)]),r("p",Le,[t[48]||(t[48]=r("strong",null,"Estimated size:",-1)),v(" ~"+n(M.value)+" KB",1)])])]),r("button",{class:"btn btn-primary w-100",onClick:qe,disabled:j.value},[j.value?(h(),s("span",Ae,"⏳ Exporting...")):(h(),s("span",Pe,"💾 Export JSON File"))],8,Ie)])):m("",!0)]),S.value?(h(),s("div",{key:0,class:f(["alert mt-3","success"===S.value.type?"alert-success":"alert-danger"])},n(S.value.message),3)):m("",!0)])])])]);var l}}}),[["__scopeId","data-v-3a56e8f4"]]),Ve={class:"compose-view"},Oe={class:"modal-content"},qe={class:"modal-body"},Ne={class:"mb-3"},_e={class:"mb-3"},ze={class:"mb-3"},Ge={class:"mb-3"},Je={class:"mb-3"},We={class:"modal-footer"},He=["disabled"],Ke={class:"modal-content"},Ye={class:"modal-body"},Qe={class:"row"},Xe={class:"col-md-6"},Ze={key:0,class:"card"},ea={class:"card-body"},aa={class:"d-flex justify-content-between"},ta={class:"d-flex justify-content-between"},la={class:"d-flex justify-content-between"},oa={class:"d-flex justify-content-between"},sa={key:0,class:"alert alert-warning mt-2 mb-0 p-2"},ra={class:"projects-screen py-4"},na={class:"card"},ia={class:"card-header compose-header"},ca={class:"row align-items-center"},da={class:"col-md-6 text-end"},ua={class:"card-body"},ba={key:0},ma={class:"list-group"},pa={class:"btn-group w-100",role:"group"},va=["onClick"],fa={class:"fw-bold d-flex align-items-center"},ga={class:"text-muted small"},ha={class:"text-muted small"},ya={key:0,class:"text-muted small"},xa=["onClick"],ka=["onClick"],wa={key:1,class:"text-center py-5"},Ca={class:"developer-toolbar"},ja={class:"container"},Sa={class:"toolbar-toggle"},Fa={key:0,class:"toolbar-content"},Ba={class:"toolbar-buttons"};e("default",y(t({__name:"ComposeView",setup(e){const a=B(),t=l(!1),u=l(!1),y=l(!1),E=l(null),U=l([]),$=l(!0),L=l(!0),I=l(null),P=l({name:"",artist:"",genre:"",lyricsText:"",audioFile:null}),A=o(()=>P.value.name&&P.value.artist&&P.value.audioFile);x(()=>P.value.lyricsText,e=>{if(!e)return;const{metadata:a}=M(e);a.title&&!P.value.name.trim()&&(P.value.name=a.title),a.author&&!P.value.artist.trim()&&(P.value.artist=a.author)});const R=()=>{t.value=!1,G()},V=()=>{u.value=!1},O=()=>{I.value=D.getStorageInfo(),u.value=!0},q=async()=>{if(confirm("This will remove all cached audio files from storage. Projects will still work but may need to re-select audio files. Continue?")){const e=await D.clearOldAudioFiles();alert(`Cleared ${e} audio files from cache.`),I.value=D.getStorageInfo()}},N=async()=>{const e=await D.testIndexedDBConnection();let a="🔍 IndexedDB Test Results:\n\n";e.available?a+="✅ IndexedDB is supported by your browser\n":a+="❌ IndexedDB is NOT supported by your browser\n",e.canStore?(a+="✅ Can store files in IndexedDB\n",a+="🎵 Your 4-5MB audio files will work perfectly!"):(a+="❌ Cannot store files in IndexedDB\n",e.error&&(a+=`Error: ${e.error}\n`),a+="⚠️ Will fallback to other storage methods"),alert(a)},_=e=>{switch(e){case"base64":return"bg-success";case"indexeddb":return"bg-info";case"reference":return"bg-warning";default:return"bg-secondary"}},z=e=>{switch(e){case"base64":return"📦 Base64";case"indexeddb":return"🗄️ IndexedDB";case"reference":return"📁 Reference";default:return"Unknown"}},G=()=>{P.value={name:"",artist:"",genre:"",lyricsText:"",audioFile:null}},J=e=>{const a=e.target;a.files&&a.files[0]&&(P.value.audioFile=a.files[0])},W=async()=>{if(console.log("createProject called",{canCreate:A.value,name:P.value.name,artist:P.value.artist,audioFile:P.value.audioFile?.name}),!A.value)return void console.log("Cannot create project - missing requirements");const{lyrics:e}=M(P.value.lyricsText),t=`project-${Date.now()}`;console.log("Storing audio file...");const l=await D.storeAudioFile(P.value.audioFile,t),o={id:t,name:P.value.name,artist:P.value.artist,genre:P.value.genre||"Unknown",createdAt:new Date,updatedAt:new Date,audioFile:{name:P.value.audioFile.name,file:P.value.audioFile,url:URL.createObjectURL(P.value.audioFile),storedData:l},lyrics:e,timings:[],isCompleted:!1};U.value.push(o);try{K(),R(),console.log("Project created successfully:",o.name),$.value&&a.push(`/timing/${t}`)}catch(s){console.error("Error creating project:",s),alert("Error creating project: "+s)}},H=()=>{y.value=!1,E.value=null},K=()=>{try{const e=U.value.map(e=>({...e,audioFile:{...e.audioFile,file:null,url:void 0}}));localStorage.setItem("karaokeProjects",JSON.stringify(e)),console.log(`💾 Saved ${U.value.length} projects to storage`),e.forEach((e,a)=>{console.log(`Project ${a}: ${e.name} - StoredData preserved:`,{hasStoredData:!!e.audioFile.storedData,storageType:e.audioFile.storedData?.storageType,duration:e.audioFile.duration})})}catch(e){console.error("Error saving projects:",e)}},Y=()=>{let e=0;U.value.forEach(a=>{if(a.audioFile&&!a.audioFile.storedData){let t="reference";const l=a.audioFile.file?.lastModified||0,o=`audio_${a.id}_${a.audioFile.name}_${l}`;localStorage.getItem(`audio_${o}`)&&(t="base64"),a.audioFile.storedData={name:a.audioFile.name,size:0,type:"audio/mpeg",lastModified:Date.now(),storageType:t},e++,console.log(`🔧 Fixed storage badge for project: ${a.name} -> ${t}`)}}),e>0?(K(),alert(`Fixed storage badges for ${e} project(s). Refresh the page to see the changes.`)):alert("All projects already have proper storage data.")},Q=()=>{confirm("Are you sure you want to delete ALL saved projects? This cannot be undone.")&&(localStorage.removeItem("karaokeProjects"),U.value=[],console.log("All projects cleared from localStorage"),alert("All projects have been cleared. You can now start fresh!"))},X=()=>{L.value=!L.value},Z=e=>{"Escape"===e.code&&(t.value?(e.preventDefault(),R()):u.value&&(e.preventDefault(),V()))};return k(async()=>{(()=>{const e=localStorage.getItem("karaokeProjects");if(e)try{const a=JSON.parse(e);U.value=a.map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),audioFile:{...e.audioFile,file:null}})),console.log(`Loaded ${U.value.length} projects from storage`),U.value.forEach((e,a)=>{console.log(`🔍 Project ${a+1}: "${e.name}"`),console.log("   audioFile:",e.audioFile),console.log("   storedData:",e.audioFile?.storedData),console.log("   storageType:",e.audioFile?.storedData?.storageType),console.log("   Badge will show:",z(e.audioFile?.storedData?.storageType||"unknown")),console.log("---")})}catch(a){console.error("Error loading projects:",a)}})(),await new Promise(e=>setTimeout(e,100));const e=D.getStorageInfo();console.log("🔍 Audio storage service initialized:",e),window.indexedDB?console.log("✅ IndexedDB is available in this browser"):console.warn("❌ IndexedDB is NOT available in this browser"),e.quotaUsedMB>.9*e.quotaLimitMB&&console.warn("⚠️ Storage quota nearly full:",e.quotaUsedMB,"/",e.quotaLimitMB,"MB"),"indexeddb"===e.method?console.log("🗄️ Using IndexedDB - perfect for 4-5MB files!"):console.log("📦 Using fallback storage method:",e.method),window.addEventListener("keydown",Z)}),w(()=>{$.value=!1,window.removeEventListener("keydown",Z)}),(e,l)=>{const o=T("router-link");return h(),s(i,null,[r("div",Ve,[t.value?(h(),s("div",{key:0,class:f(["modal",{show:t.value}]),onClick:R},[r("div",{class:"modal-dialog",onClick:l[4]||(l[4]=g(()=>{},["stop"]))},[r("div",Oe,[r("div",{class:"modal-header"},[l[9]||(l[9]=r("h5",{class:"modal-title"},"Create New Karaoke Project",-1)),r("button",{type:"button",class:"btn-close",onClick:R})]),r("div",qe,[r("form",{onSubmit:g(W,["prevent"])},[r("div",Ne,[l[10]||(l[10]=r("label",{for:"projectName",class:"form-label"},"Song Title *",-1)),d(r("input",{type:"text",class:"form-control",id:"projectName","onUpdate:modelValue":l[0]||(l[0]=e=>P.value.name=e),required:"",placeholder:"Enter song title"},null,512),[[p,P.value.name]])]),r("div",_e,[l[11]||(l[11]=r("label",{for:"projectArtist",class:"form-label"},"Artist *",-1)),d(r("input",{type:"text",class:"form-control",id:"projectArtist","onUpdate:modelValue":l[1]||(l[1]=e=>P.value.artist=e),required:"",placeholder:"Enter artist name"},null,512),[[p,P.value.artist]])]),r("div",ze,[l[13]||(l[13]=r("label",{for:"projectGenre",class:"form-label"},"Genre",-1)),d(r("select",{class:"form-control",id:"projectGenre","onUpdate:modelValue":l[2]||(l[2]=e=>P.value.genre=e)},[...l[12]||(l[12]=[C('<option value="" data-v-6032be75>Select Genre</option><option value="Pop" data-v-6032be75>Pop</option><option value="Rock" data-v-6032be75>Rock</option><option value="Country" data-v-6032be75>Country</option><option value="Hip-Hop" data-v-6032be75>Hip-Hop</option><option value="R&amp;B" data-v-6032be75>R&amp;B</option><option value="Jazz" data-v-6032be75>Jazz</option><option value="Classical" data-v-6032be75>Classical</option><option value="Other" data-v-6032be75>Other</option>',9)])],512),[[b,P.value.genre]])]),r("div",Ge,[l[14]||(l[14]=r("label",{for:"audioFile",class:"form-label"},"Audio File (MP3, WAV) *",-1)),r("input",{type:"file",class:"form-control",id:"audioFile",accept:"audio/*",onChange:J,required:""},null,32)]),r("div",Je,[l[15]||(l[15]=r("label",{for:"lyrics",class:"form-label"},"Lyrics",-1)),d(r("textarea",{class:"form-control",id:"lyrics",rows:"8","onUpdate:modelValue":l[3]||(l[3]=e=>P.value.lyricsText=e),placeholder:"Paste your lyrics here (one line per verse/chorus line)..."},null,512),[[p,P.value.lyricsText]]),l[16]||(l[16]=r("div",{class:"form-text"},"Each line will become a timing point for synchronization",-1))])],32)]),r("div",We,[r("button",{type:"button",class:"btn btn-secondary",onClick:R},"Cancel"),r("button",{type:"button",class:"btn btn-primary",onClick:W,disabled:!A.value}," Create Project ",8,He)])])])],2)):m("",!0),u.value?(h(),s("div",{key:1,class:f(["modal",{show:u.value}]),onClick:V},[r("div",{class:"modal-dialog",onClick:l[5]||(l[5]=g(()=>{},["stop"]))},[r("div",Ke,[r("div",{class:"modal-header"},[l[17]||(l[17]=r("h5",{class:"modal-title"},"🗂️ Audio Storage Information",-1)),r("button",{type:"button",class:"btn-close",onClick:V})]),r("div",Ye,[r("div",Qe,[l[27]||(l[27]=C('<div class="col-md-6" data-v-6032be75><h6 data-v-6032be75>Storage Methods</h6><div class="list-group list-group-flush" data-v-6032be75><div class="list-group-item d-flex justify-content-between align-items-center" data-v-6032be75><span data-v-6032be75>📦 Base64 (localStorage)</span><span class="badge bg-warning rounded-pill" data-v-6032be75>≤1MB</span></div><div class="list-group-item d-flex justify-content-between align-items-center" data-v-6032be75><span data-v-6032be75>🗄️ IndexedDB</span><span class="badge bg-success rounded-pill" data-v-6032be75>4-5MB+ Files</span></div><div class="list-group-item d-flex justify-content-between align-items-center" data-v-6032be75><span data-v-6032be75>📁 Reference</span><span class="badge bg-warning rounded-pill" data-v-6032be75>Re-select</span></div></div></div>',1)),r("div",Xe,[l[26]||(l[26]=r("h6",null,"Current Usage",-1)),I.value?(h(),s("div",Ze,[r("div",ea,[r("div",aa,[l[18]||(l[18]=r("span",null,"Preferred:",-1)),r("strong",null,n(I.value.method),1)]),r("div",ta,[l[19]||(l[19]=r("span",null,"Audio Files:",-1)),r("strong",null,n(I.value.count),1)]),r("div",la,[l[20]||(l[20]=r("span",null,"Audio Size:",-1)),r("strong",null,n(I.value.sizeMB)+" MB",1)]),r("div",oa,[l[21]||(l[21]=r("span",null,"Storage Used:",-1)),r("strong",null,n(I.value.quotaUsedMB)+"/"+n(I.value.quotaLimitMB)+" MB",1)]),I.value.quotaUsedMB>.8*I.value.quotaLimitMB?(h(),s("div",sa,[...l[22]||(l[22]=[r("small",null,[r("i",{class:"bi bi-exclamation-triangle"}),v(" Storage nearly full!")],-1)])])):m("",!0)])])):m("",!0),r("div",{class:"mt-2"},[r("button",{class:"btn btn-outline-info btn-sm w-100 mb-2",onClick:N},[...l[23]||(l[23]=[r("i",{class:"bi bi-gear"},null,-1),v(" Test IndexedDB ",-1)])]),r("button",{class:"btn btn-outline-success btn-sm w-100 mb-2",onClick:Y},[...l[24]||(l[24]=[r("i",{class:"bi bi-wrench"},null,-1),v(" Fix Storage Badges ",-1)])]),r("button",{class:"btn btn-outline-warning btn-sm w-100",onClick:q},[...l[25]||(l[25]=[r("i",{class:"bi bi-trash3"},null,-1),v(" Clear Audio Cache ",-1)])])])])]),l[28]||(l[28]=C('<hr data-v-6032be75><div class="alert alert-info" data-v-6032be75><h6 data-v-6032be75><i class="bi bi-info-circle" data-v-6032be75></i> Storage Methods Explained:</h6><ul class="mb-0" data-v-6032be75><li data-v-6032be75><strong data-v-6032be75>IndexedDB:</strong> Best for 4-5MB+ files - up to ~1GB capacity, persistent storage</li><li data-v-6032be75><strong data-v-6032be75>Base64:</strong> Small files only (≤1MB) - fastest loading but limited by browser quota</li><li data-v-6032be75><strong data-v-6032be75>Reference:</strong> Fallback method - you&#39;ll need to re-select files when loading</li></ul><div class="mt-2 p-2 bg-light rounded" data-v-6032be75><small data-v-6032be75><strong data-v-6032be75>💡 IndexedDB is a built-in browser feature:</strong></small><br data-v-6032be75><small data-v-6032be75>• No setup required - works automatically</small><br data-v-6032be75><small data-v-6032be75>• Available in all modern browsers (Chrome, Firefox, Safari, Edge)</small><br data-v-6032be75><small data-v-6032be75>• Perfect for your 4-5MB audio files - no quota issues!</small><br data-v-6032be75><small data-v-6032be75>• Use &quot;Test IndexedDB&quot; button to verify it&#39;s working</small></div></div>',2))]),r("div",{class:"modal-footer"},[r("button",{type:"button",class:"btn btn-secondary",onClick:V},"Close")])])])],2)):m("",!0),r("div",ra,[r("div",na,[r("div",ia,[r("div",ca,[l[32]||(l[32]=r("div",{class:"col-md-6"},[r("h2",{class:"mb-1"},"🎼 Karaoke Composer"),r("p",{class:"mb-0 text-muted"},"Create and sync your karaoke tracks")],-1)),r("div",da,[r("button",{class:"btn btn-primary me-2",onClick:l[6]||(l[6]=e=>t.value=!0)},[...l[29]||(l[29]=[r("i",{class:"bi bi-plus-circle"},null,-1),v(" New Project ",-1)])]),r("button",{class:"btn btn-info btn-sm me-2",onClick:O,title:"Audio storage information"},[...l[30]||(l[30]=[r("i",{class:"bi bi-info-circle"},null,-1),v(" Storage ",-1)])]),r("button",{class:"btn btn-danger btn-sm",onClick:Q,title:"Clear all saved projects"},[...l[31]||(l[31]=[r("i",{class:"bi bi-trash3"},null,-1),v(" Clear All ",-1)])])])])]),r("div",ua,[U.value.length>0?(h(),s("div",ba,[l[38]||(l[38]=r("h5",{class:"mb-3"},"Your Projects",-1)),r("div",ma,[(h(!0),s(i,null,c(U.value,e=>{return h(),s("div",{key:e.id,class:"list-group-item p-0 project-item"},[r("div",pa,[r("button",{class:"btn btn-outline-secondary text-start flex-grow-1 project-content-btn",onClick:t=>(async e=>{$.value&&a.push(`/timing/${e.id}`)})(e)},[r("div",fa,[l[33]||(l[33]=r("i",{class:"bi bi-music-note-beamed me-2 text-primary"},null,-1)),v(" "+n(e.name),1)]),r("div",ga,"by "+n(e.artist)+" • "+n(e.genre),1),r("div",ha,[l[34]||(l[34]=r("i",{class:"bi bi-clock me-1"},null,-1)),v(" Last updated "+n((t=e.updatedAt,new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t))),1)]),e.audioFile?(h(),s("div",ya,[l[35]||(l[35]=r("i",{class:"bi bi-file-music me-1"},null,-1)),v(" "+n(e.audioFile.name)+" ",1),r("span",{class:f(["badge ms-2",_(e.audioFile.storedData?.storageType||"unknown")])},n(z(e.audioFile.storedData?.storageType||"unknown")),3)])):m("",!0)],8,va),r("button",{class:"btn btn-success export-btn",onClick:g(a=>(e=>{E.value=e,y.value=!0})(e),["stop"]),title:"Export project for terminal demo"},[...l[36]||(l[36]=[r("i",{class:"bi bi-download"},null,-1)])],8,xa),r("button",{class:"btn btn-warning delete-btn",onClick:g(a=>(async e=>{if(confirm(`Are you sure you want to delete "${e.name}"? This action cannot be undone.`)){const a=U.value.findIndex(a=>a.id===e.id);a>-1&&(U.value.splice(a,1),K(),console.log(`Project "${e.name}" deleted successfully`))}})(e),["stop"]),title:"Delete project"},[...l[37]||(l[37]=[r("i",{class:"bi bi-trash3"},null,-1)])],8,ka)])]);var t}),128))])])):(h(),s("div",wa,[l[40]||(l[40]=r("i",{class:"bi bi-music-note-list display-1 text-muted mb-3"},null,-1)),l[41]||(l[41]=r("h5",{class:"text-muted"},"No projects yet",-1)),l[42]||(l[42]=r("p",{class:"text-muted"},"Create your first karaoke project to get started",-1)),r("button",{class:"btn btn-primary btn-lg",onClick:l[7]||(l[7]=e=>t.value=!0)},[...l[39]||(l[39]=[r("i",{class:"bi bi-plus-circle me-2"},null,-1),v("Create Your First Project ",-1)])])]))])])])]),r("div",Ca,[r("div",ja,[r("div",{class:"toolbar-header",onClick:X},[l[43]||(l[43]=r("div",{class:"toolbar-label"},[r("i",{class:"bi bi-code-slash me-1"}),r("small",{class:"text-muted"},"Developer Tools")],-1)),r("div",Sa,[r("i",{class:f(["bi bi-chevron-down",{"rotate-180":!L.value}])},null,2)])]),L.value?(h(),s("div",Fa,[r("div",Ba,[j(o,{to:"/test-timing",class:"btn btn-outline-primary btn-sm me-2"},{default:S(()=>[...l[44]||(l[44]=[r("i",{class:"bi bi-play-circle me-1"},null,-1),v(" Test Word Timing Editor ",-1)])]),_:1}),r("button",{class:"btn btn-outline-secondary btn-sm me-2",onClick:l[8]||(l[8]=e=>u.value=!0)},[...l[45]||(l[45]=[r("i",{class:"bi bi-database me-1"},null,-1),v(" Storage Info ",-1)])]),r("button",{class:"btn btn-outline-info btn-sm",onClick:Y},[...l[46]||(l[46]=[r("i",{class:"bi bi-wrench me-1"},null,-1),v(" Fix Badges ",-1)])])])])):m("",!0)])]),y.value&&E.value?(h(),F(Re,{key:0,project:E.value,onClose:H},null,8,["project"])):m("",!0)],64)}}}),[["__scopeId","data-v-6032be75"]]))}}});
//# sourceMappingURL=ComposeView-legacy-7b0f54cb.js.map
