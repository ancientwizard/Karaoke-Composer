System.register(["./index-legacy-1803f8de.js","./WordTimingEditor-legacy-6e8be2c8.js","./lyricsParser-legacy-fd32a37b.js"],function(e,t){"use strict";var o,a,l,n,i,s,r,d,c,u,m,h,v,g,p,b,f,x,w,y,T,k,C,N,M;return{setters:[e=>{o=e.d,a=e.r,l=e.c,n=e.l,i=e.a,s=e.b,r=e.q,d=e.s,c=e.i,u=e.n,m=e.p,h=e.w,v=e.h,g=e.t,p=e.F,b=e.e,f=e.g,x=e.y,w=e.o,y=e._},e=>{T=e.W,k=e.R},e=>{C=e.a,N=e.p,M=e.T}],execute:function(){var t=document.createElement("style");function I(){const e=[];let t=0,o=0;const a=.4;console.log("🎵 Generating lyrics with: wordDuration=0.4s, beatInterval=0.8s"),console.log(`⚙️ Using centralized timing: minGap=${C.word.collisionMargin}ms, minSyllable=${C.syllable.minDuration}ms`);const{lyrics:l,metadata:n}=N("[@TITLE:Meet Me In November]\n[@AUTHOR:Ancient Wizard]\n\n[@CAPTION:You GO Marry Poppins!]\nSu/per/cal/i/frag/i/lis/tic/ex/pi/al/i/do/cious!\n\n[@CAPTION:Verse 1]\nMeet me in No/vem/ber, like a song of sto/ries told.\nSo per/fect it can't be real, yet hope will make it so.\nSpeak my name with love, and I will know your soul.\nWhere love can find a voice, two hearts will live as one.\n\n[@CAPTION:Verse 2]\nWe meet in No/vem/ber, like a song of sto/ries told.\nSo per/fect it be/came real, where hope has made it so.\nYou spoke my name with love; you'd al/ways felt it so.\nI al/rea/dy fall/ing, my heart knew it was home.\n\n[@CAPTION:Pre Chorus]\nCome meet me this No/vem/ber, to live our life fore/told.\nOur Mo/ments yet to hap/pen, al/rea/dy feel like old.\n\n[@CAPTION:Chorus]\nI Choose You! Wal/king hand in hand.\nI Choose You! Danc/ing through the night.\nI Choose You.\n\n[@CAPTION:Verse 3]\nOur time a con/ver/sa/tion, our words a love song.\nWe sang in/to each ot/her, where love we grew made strong.\nIn that per/fect mel/o/dy, our souls had found their home.\n\n[@CAPTION:Verse 4]\nYou're my Tex/as in No/vem/ber; our life made a new.\nSo per/fect it be/came truth, where hope has made it so.\nI al/rea/dy fall/ing, my heart has come home.\n\n[@CAPTION:Chorus]\nI Choose You! Now and in Nov/em/ber.\nI Choose You! Now and in for/e/ver.\nI Choose You!\n\n[@CAPTION:Bridge]\nWe star/ted in, A Tex/as No/vem/ber,\nand in that mo/ment, you found your heart a home.\n\n[@CAPTION:Pre Chorus (reprise)]\nCome meet me in No/vem/ber, to live our life fore/told.\nOur mo/ments yet to hap/pen, al/rea/dy feel like old.\n\n[@CAPTION:Final Chorus]\nYou Choose Me! In all No/vem/ber.\nYou Choose Me! Make it for/e/ver.\n\n[@CAPTION:(whisper)]\nI do.\n");console.log("📋 Parsed metadata:",{title:n.title,author:n.author,captions:n.captions?.length||0});const i=l.filter(e=>"lyrics"===e.type||!e.type);console.log(`🎵 Processing ${i.length} lyrics lines (skipping ${l.length-i.length} metadata lines)`);for(const s of i){const l=s.text;if(!l.trim())continue;if(l.trim().startsWith("(")&&l.trim().endsWith(")")){const a=l.trim().slice(1,-1);e.push(W(o++,a,t,t+1)),t+=1.5;continue}const n=l.split(/\s+/).filter(e=>e.trim());for(const i of n){const l=i.replace(/[.,!?;:]/g,""),n=i.match(/[.,!?;:]/g)?.[0]||"";let s=a;if(l.includes("/")){const i=l.split("/"),r=[],d=M.calculateSyllableWeights(i.length),c=d.reduce((e,t)=>e+t,0),u=C.syllable.minDuration/1e3,m=u*i.length;a<m&&(s=m,console.warn(`⚠️ Test data: Extended word "${l}" from 0.4s to ${s}s for ${i.length} syllables`));const h=d.map(e=>u+e/c*(s-m));let v=t;i.forEach((e,t)=>{const o=v+h[t];r.push({text:e+(t===i.length-1?n:""),startTime:v,endTime:o}),v=o}),e.push({id:"word-"+o++,text:l.replace(/\//g,"")+n,startTime:t,endTime:t+s,syllables:r})}else l.length>6?e.push({id:"word-"+o++,text:"FULL",startTime:t,endTime:t+a,syllables:[{text:"FULL",startTime:t,endTime:t+a}]}):e.push(W(o++,l+n,t,t+s));const r=.8-s,d=C.word.collisionMargin/1e3,c=Math.max(.6*r,d);o<=5&&console.log(`📏 Word "${l}": duration=${s.toFixed(3)}s, gap=${c.toFixed(3)}s, next=${(t+s+c).toFixed(3)}s`),t+=s+c}t+=.4}return console.log("📊 First 5 words with gaps:"),e.slice(0,5).forEach((t,o)=>{const a=e[o+1],l=a?a.startTime-t.endTime:0;console.log(`  ${o+1}. "${t.text}": ${t.startTime.toFixed(3)}s - ${t.endTime.toFixed(3)}s`+(l>0?` → gap: ${l.toFixed(3)}s`:" (last)"))}),e}function W(e,t,o,a){return{id:`word-${e}`,text:t,startTime:o,endTime:a,syllables:[{text:t,startTime:o,endTime:a}]}}t.textContent=".test-timing-page[data-v-340e981f]{min-height:100vh;background:#f8f9fa}.timing-editor-section[data-v-340e981f]{background:white;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.controls-section[data-v-340e981f],.lyrics-section[data-v-340e981f]{background:white;padding:15px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.lyrics-display[data-v-340e981f]{max-height:300px;overflow-y:auto}.lyrics-word[data-v-340e981f]{cursor:pointer;padding:2px 4px;border-radius:3px;transition:background-color .2s;display:inline-block}.lyrics-word[data-v-340e981f]:hover{background-color:rgba(0,123,255,.1)}.lyrics-word.selected-word[data-v-340e981f]{background-color:rgba(255,193,7,.3);font-weight:700}.debug-section[data-v-340e981f]{background:white;padding:15px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);margin-top:20px}.debug-box[data-v-340e981f]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:4px;padding:10px;max-height:200px;overflow-y:auto;font-family:Courier New,monospace;font-size:12px}.debug-word[data-v-340e981f]{padding:2px 0;border-bottom:1px solid #eee}.lyrics-line[data-v-340e981f]{line-height:1.8}.help-panel-container[data-v-340e981f]{position:fixed;top:50%;left:0;z-index:1000;transform:translateY(-50%)}.help-panel[data-v-340e981f]{position:relative;width:250px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);border-radius:0 8px 8px 0;box-shadow:2px 0 12px rgba(0,0,0,.2);transform:translate(-230px);transition:transform .3s ease-in-out;color:#fff}.help-panel.visible[data-v-340e981f]{transform:translate(0)}.help-tab[data-v-340e981f]{position:absolute;right:-40px;top:50%;transform:translateY(-50%);background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:8px 12px 8px 8px;border-radius:0 8px 8px 0;cursor:pointer;writing-mode:vertical-rl;text-orientation:mixed;font-size:12px;font-weight:600;white-space:nowrap;box-shadow:2px 0 8px rgba(0,0,0,.15)}.help-tab i[data-v-340e981f]{margin-bottom:4px;font-size:14px}.help-content[data-v-340e981f]{padding:20px}.help-content h5[data-v-340e981f]{margin:0 0 15px;font-size:16px;font-weight:600;color:#fff;border-bottom:1px solid rgba(255,255,255,.2);padding-bottom:8px}.help-content h5 i[data-v-340e981f]{margin-right:8px;color:gold}.help-list[data-v-340e981f]{list-style:none;padding:0;margin:0}.help-list li[data-v-340e981f]{padding:6px 0;font-size:13px;line-height:1.4;border-bottom:1px solid rgba(255,255,255,.1)}.help-list li[data-v-340e981f]:last-child{border-bottom:none}.help-list li strong[data-v-340e981f]{color:gold;font-weight:600}.help-tab[data-v-340e981f]:hover,.help-panel:hover .help-tab[data-v-340e981f]{background:linear-gradient(135deg,#5a6fd8 0%,#6a4190 100%)}\n",document.head.appendChild(t);const $={class:"test-timing-page"},S={class:"header bg-light p-3 mb-4"},O={class:"container"},F={class:"row align-items-center"},P={class:"col"},A={"aria-label":"breadcrumb",class:"mb-2"},E={class:"breadcrumb mb-0"},z={class:"breadcrumb-item"},D={class:"col-auto"},Y={class:"help-panel-container"},V={class:"container"},U={class:"timing-editor-section mb-4"},L={class:"controls-section mb-4"},R={class:"row"},_={class:"col-md-4"},j={class:"row"},G={class:"col"},q=["max"],B={class:"col"},H=["max"],Z={class:"col-md-4"},J={class:"form-control form-control-sm bg-light"},K={class:"col-md-4"},Q={class:"form-control form-control-sm bg-light"},X={class:"lyrics-section mb-4"},ee={class:"lyrics-display p-3 border rounded bg-light"},te=["onClick"],oe={class:"text-muted"},ae={key:0,class:"debug-section"},le={class:"row"},ne={class:"col-md-6"},ie={class:"debug-box"},se={key:0,class:"text-muted"},re={class:"col-md-6"},de={class:"debug-box"},ce={key:0},ue={key:1,class:"text-muted"};e("default",y(o({__name:"TestTimingView",setup(e){const t=a([]),o=a(60),y=a(0),C=a(3),N=a(null),M=a(!0),W=a(!1),me=l(()=>M.value),he=l(()=>{const e=Number(y.value);return isNaN(e)?0:Math.max(0,Math.min(e,o.value))}),ve=l(()=>{const e=Number(C.value);return isNaN(e)?3:Math.max(.1,Math.min(e,o.value-he.value))}),ge=l(()=>he.value+ve.value),pe=l(()=>N.value?t.value.find(e=>e.id===N.value):null),be=l(()=>t.value.filter(e=>e.endTime>=he.value&&e.startTime<=ge.value)),fe=l(()=>{const e=[];let o=[],a=0;for(const l of t.value)(l.startTime-a>1||o.length>8)&&o.length>0&&(e.push([...o]),o=[]),o.push(l),a=l.endTime;return o.length>0&&e.push(o),e}),xe=e=>{if(N.value=e,e){const o=t.value.find(t=>t.id===e);o&&console.log(`Selected word: "${o.text}"`)}},we=e=>{e.forEach(e=>{const o=t.value.findIndex(t=>t.id===e.id);if(-1!==o){const a=t.value[o],l=a.startTime,n=a.endTime,i=e.startTime,s=e.endTime,r=a.syllables.map(e=>({text:e.text,startTime:Math.round(1e3*e.startTime),endTime:Math.round(1e3*e.endTime)})),d=k.fromAbsoluteSyllables(a.id,a.text,Math.round(1e3*l),Math.round(1e3*n),r);let c;const u=Math.abs(i-l)>.01,m=Math.abs(s-n)>.01;u&&!m?(c=d.moveWord(Math.round(1e3*i)),M.value&&console.log(`MOVE: "${a.text}" moved to ${i.toFixed(2)}s`)):m&&!u?(c=d.resizeWordEnd(Math.round(1e3*s)),M.value&&console.log(`RESIZE: "${a.text}" resized to ${s.toFixed(2)}s`)):u&&m?(c=d.moveWord(Math.round(1e3*i)).resizeWordEnd(Math.round(1e3*s)),M.value&&console.log(`MOVE & RESIZE: "${a.text}" moved and resized`)):c=d;const h=c.getWordData(),v=c.getAbsoluteSyllables();a.startTime=h.startTime/1e3,a.endTime=h.endTime/1e3,a.syllables=v.map(e=>({text:e.text,startTime:e.startTime/1e3,endTime:e.endTime/1e3}))}}),console.log("Words updated:",e.length)},ye=e=>{xe(e)},Te=()=>{t.value=I(),o.value=function(){const e=I();return e.length>0?Math.max(...e.map(e=>e.endTime))+2:60}(),N.value=null,console.log("Timing data reset")};return n(()=>{Te()}),(e,a)=>{const l=x("router-link");return w(),i("div",$,[s("div",S,[s("div",O,[s("div",F,[s("div",P,[s("nav",A,[s("ol",E,[s("li",z,[r(l,{to:"/compose",class:"text-decoration-none"},{default:d(()=>[...a[5]||(a[5]=[s("i",{class:"bi bi-arrow-left"},null,-1),c(" Back to Projects ",-1)])]),_:1})]),a[6]||(a[6]=s("li",{class:"breadcrumb-item active"},"Word Timing Test",-1))])]),a[7]||(a[7]=s("h2",{class:"mb-1"},"Word Timing Editor Test",-1)),a[8]||(a[8]=s("p",{class:"mb-0 text-muted"},'Testing drag & drop word timing with "November" lyrics',-1))]),s("div",D,[s("button",{class:"btn btn-primary btn-sm me-2",onClick:Te},[...a[9]||(a[9]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),c(" Reset",-1)])]),s("button",{class:"btn btn-info btn-sm",onClick:a[0]||(a[0]=e=>M.value=!M.value)},[...a[10]||(a[10]=[s("i",{class:"bi bi-bug"},null,-1),c(" Debug",-1)])])])])])]),s("div",Y,[s("div",{class:u(["help-panel",{visible:W.value}]),onMouseenter:a[1]||(a[1]=e=>W.value=!0),onMouseleave:a[2]||(a[2]=e=>W.value=!1)},[...a[11]||(a[11]=[m('<div class="help-tab" data-v-340e981f><i class="bi bi-question-circle" data-v-340e981f></i><span data-v-340e981f>Help</span></div><div class="help-content" data-v-340e981f><h5 data-v-340e981f><i class="bi bi-info-circle" data-v-340e981f></i> Word Timing Editor</h5><ul class="help-list" data-v-340e981f><li data-v-340e981f><strong data-v-340e981f>Select:</strong> Click on any word box to select it</li><li data-v-340e981f><strong data-v-340e981f>Move:</strong> Drag a word box left/right to change its start time</li><li data-v-340e981f><strong data-v-340e981f>Resize:</strong> Drag the green handle on the right edge to change duration</li><li data-v-340e981f><strong data-v-340e981f>Syllables:</strong> Drag orange dividers within multi-syllable words</li><li data-v-340e981f><strong data-v-340e981f>View:</strong> Adjust the view window controls above to zoom in/out</li></ul></div>',2)])],34)]),s("div",V,[s("div",U,[a[12]||(a[12]=s("h4",null,"Word Timing Editor",-1)),r(T,{words:t.value,duration:o.value,"view-start":he.value,"view-end":ge.value,"show-debug":me.value,"show-background":!0,"show-border":!0,"onUpdate:words":we,onSelectWord:ye},null,8,["words","duration","view-start","view-end","show-debug"])]),s("div",L,[s("div",R,[s("div",_,[a[13]||(a[13]=s("label",{class:"form-label"},"View Window (seconds)",-1)),s("div",j,[s("div",G,[h(s("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>y.value=e),type:"number",class:"form-control form-control-sm",min:"0",max:o.value,step:"0.5",placeholder:"Start"},null,8,q),[[v,y.value,void 0,{number:!0}]])]),s("div",B,[h(s("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>C.value=e),type:"number",class:"form-control form-control-sm",min:"0.1",max:o.value-he.value,step:"0.5",placeholder:"Duration"},null,8,H),[[v,C.value,void 0,{number:!0}]])])])]),s("div",Z,[a[14]||(a[14]=s("label",{class:"form-label"},"Selected Word",-1)),s("div",J,g(pe.value?`"${pe.value.text}" (${pe.value.startTime.toFixed(1)}s - ${pe.value.endTime.toFixed(1)}s)`:"None"),1)]),s("div",K,[a[15]||(a[15]=s("label",{class:"form-label"},"Total Duration",-1)),s("div",Q,g(o.value.toFixed(1))+" seconds ("+g(Math.floor(o.value/60))+":"+g(Math.floor(o.value%60).toString().padStart(2,"0"))+") ",1)])])]),s("div",X,[a[16]||(a[16]=s("h5",null,"Current Lyrics with Timing",-1)),s("div",ee,[(w(!0),i(p,null,b(fe.value,(e,t)=>(w(),i("div",{key:t,class:"lyrics-line mb-2"},[(w(!0),i(p,null,b(e,e=>(w(),i("span",{key:e.id,class:u(["lyrics-word me-1",{"selected-word":N.value===e.id}]),onClick:t=>xe(e.id)},[c(g(e.text)+" ",1),s("small",oe,"("+g(e.startTime.toFixed(1))+"s)",1)],10,te))),128))]))),128))])]),M.value?(w(),i("div",ae,[a[18]||(a[18]=s("h5",null,"Debug Information",-1)),s("div",le,[s("div",ne,[s("h6",null,"Words in View ("+g(be.value.length)+")",1),s("div",ie,[(w(!0),i(p,null,b(be.value,e=>(w(),i("div",{key:e.id,class:"debug-word mb-1"},[s("strong",null,g(e.text),1),c(": "+g(e.startTime.toFixed(2))+"s - "+g(e.endTime.toFixed(2))+"s ",1),e.syllables.length>1?(w(),i("span",se," ("+g(e.syllables.length)+" syllables) ",1)):f("",!0)]))),128))])]),s("div",re,[a[17]||(a[17]=s("h6",null,"Selected Word Details",-1)),s("div",de,[pe.value?(w(),i("pre",ce,g(JSON.stringify(pe.value,null,2)),1)):(w(),i("div",ue,"No word selected"))])])])])):f("",!0)])])}}}),[["__scopeId","data-v-340e981f"]]))}}});
//# sourceMappingURL=TestTimingView-legacy-6d2d077a.js.map
