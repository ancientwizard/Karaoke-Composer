import{d as Q,r as S,c as $,l as X,a as f,b as t,q as G,s as ee,i as O,n as B,p as te,w as H,h as j,t as u,F as z,e as R,g as q,y as oe,o as p,_ as se}from"./index-d671fee0.js";import{W as ie,R as le}from"./WordTimingEditor-d2295c43.js";import{a as P,p as ne,T as ae}from"./lyricsParser-c2c86582.js";const re="[@TITLE:Meet Me In November]\n[@AUTHOR:Ancient Wizard]\n\n[@CAPTION:You GO Marry Poppins!]\nSu/per/cal/i/frag/i/lis/tic/ex/pi/al/i/do/cious!\n\n[@CAPTION:Verse 1]\nMeet me in No/vem/ber, like a song of sto/ries told.\nSo per/fect it can't be real, yet hope will make it so.\nSpeak my name with love, and I will know your soul.\nWhere love can find a voice, two hearts will live as one.\n\n[@CAPTION:Verse 2]\nWe meet in No/vem/ber, like a song of sto/ries told.\nSo per/fect it be/came real, where hope has made it so.\nYou spoke my name with love; you'd al/ways felt it so.\nI al/rea/dy fall/ing, my heart knew it was home.\n\n[@CAPTION:Pre Chorus]\nCome meet me this No/vem/ber, to live our life fore/told.\nOur Mo/ments yet to hap/pen, al/rea/dy feel like old.\n\n[@CAPTION:Chorus]\nI Choose You! Wal/king hand in hand.\nI Choose You! Danc/ing through the night.\nI Choose You.\n\n[@CAPTION:Verse 3]\nOur time a con/ver/sa/tion, our words a love song.\nWe sang in/to each ot/her, where love we grew made strong.\nIn that per/fect mel/o/dy, our souls had found their home.\n\n[@CAPTION:Verse 4]\nYou're my Tex/as in No/vem/ber; our life made a new.\nSo per/fect it be/came truth, where hope has made it so.\nI al/rea/dy fall/ing, my heart has come home.\n\n[@CAPTION:Chorus]\nI Choose You! Now and in Nov/em/ber.\nI Choose You! Now and in for/e/ver.\nI Choose You!\n\n[@CAPTION:Bridge]\nWe star/ted in, A Tex/as No/vem/ber,\nand in that mo/ment, you found your heart a home.\n\n[@CAPTION:Pre Chorus (reprise)]\nCome meet me in No/vem/ber, to live our life fore/told.\nOur mo/ments yet to hap/pen, al/rea/dy feel like old.\n\n[@CAPTION:Final Chorus]\nYou Choose Me! In all No/vem/ber.\nYou Choose Me! Make it for/e/ver.\n\n[@CAPTION:(whisper)]\nI do.\n";function J(){var V,C;const n=[];let s=0,l=0;const T=.8,w=.4;console.log("ðŸŽµ Generating lyrics with: wordDuration=".concat(w,"s, beatInterval=").concat(T,"s")),console.log("âš™ï¸ Using centralized timing: minGap=".concat(P.word.collisionMargin,"ms, minSyllable=").concat(P.syllable.minDuration,"ms"));const{lyrics:W,metadata:c}=ne(re);console.log("ðŸ“‹ Parsed metadata:",{title:c.title,author:c.author,captions:((V=c.captions)==null?void 0:V.length)||0});const M=W.filter(m=>m.type==="lyrics"||!m.type);console.log("ðŸŽµ Processing ".concat(M.length," lyrics lines (skipping ").concat(W.length-M.length," metadata lines)"));for(const m of M){const v=m.text;if(!v.trim())continue;if(v.trim().startsWith("(")&&v.trim().endsWith(")")){const r=v.trim().slice(1,-1);n.push(Z(l++,r,s,s+1)),s+=1.5;continue}const h=v.split(/\s+/).filter(r=>r.trim());for(const r of h){const x=r.replace(/[.,!?;:]/g,""),k=((C=r.match(/[.,!?;:]/g))==null?void 0:C[0])||"";let g=w;if(x.includes("/")){const e=x.split("/"),d=[],o=ae.calculateSyllableWeights(e.length),D=o.reduce((y,a)=>y+a,0),b=P.syllable.minDuration/1e3,_=b*e.length;w<_&&(g=_,console.warn('âš ï¸ Test data: Extended word "'.concat(x,'" from ').concat(w,"s to ").concat(g,"s for ").concat(e.length," syllables")));const E=o.map(y=>{const a=b,N=y/D*(g-_);return a+N});let F=s;e.forEach((y,a)=>{const N=F+E[a];d.push({text:y+(a===e.length-1?k:""),startTime:F,endTime:N}),F=N}),n.push({id:"word-".concat(l++),text:x.replace(/\//g,"")+k,startTime:s,endTime:s+g,syllables:d})}else x.length>6?n.push({id:"word-".concat(l++),text:"FULL",startTime:s,endTime:s+w,syllables:[{text:"FULL",startTime:s,endTime:s+w}]}):n.push(Z(l++,x+k,s,s+g));const L=T-g,A=P.word.collisionMargin/1e3,i=Math.max(L*.6,A);l<=5&&console.log('ðŸ“ Word "'.concat(x,'": duration=').concat(g.toFixed(3),"s, gap=").concat(i.toFixed(3),"s, next=").concat((s+g+i).toFixed(3),"s")),s+=g+i}s+=T*.5}return console.log("ðŸ“Š First 5 words with gaps:"),n.slice(0,5).forEach((m,v)=>{const h=n[v+1],r=h?h.startTime-m.endTime:0;console.log("  ".concat(v+1,'. "').concat(m.text,'": ').concat(m.startTime.toFixed(3),"s - ").concat(m.endTime.toFixed(3),"s")+(r>0?" â†’ gap: ".concat(r.toFixed(3),"s"):" (last)"))}),n}function Z(n,s,l,T){return{id:"word-".concat(n),text:s,startTime:l,endTime:T,syllables:[{text:s,startTime:l,endTime:T}]}}function de(){const n=J();return n.length>0?Math.max(...n.map(s=>s.endTime))+2:60}const ue={class:"test-timing-page"},ce={class:"header bg-light p-3 mb-4"},me={class:"container"},ve={class:"row align-items-center"},he={class:"col"},ge={"aria-label":"breadcrumb",class:"mb-2"},be={class:"breadcrumb mb-0"},fe={class:"breadcrumb-item"},pe={class:"col-auto"},Te={class:"help-panel-container"},we={class:"container"},ye={class:"timing-editor-section mb-4"},xe={class:"controls-section mb-4"},_e={class:"row"},We={class:"col-md-4"},Ce={class:"row"},Ne={class:"col"},Ie=["max"],Me={class:"col"},Se=["max"],$e={class:"col-md-4"},ke={class:"form-control form-control-sm bg-light"},De={class:"col-md-4"},Ee={class:"form-control form-control-sm bg-light"},Fe={class:"lyrics-section mb-4"},Oe={class:"lyrics-display p-3 border rounded bg-light"},Ve=["onClick"],Ae={class:"text-muted"},Pe={key:0,class:"debug-section"},Le={class:"row"},Ye={class:"col-md-6"},ze={class:"debug-box"},Re={key:0,class:"text-muted"},Ue={class:"col-md-6"},Ge={class:"debug-box"},Be={key:0},He={key:1,class:"text-muted"},je=Q({__name:"TestTimingView",setup(n){const s=S([]),l=S(60),T=S(0),w=S(3),W=S(null),c=S(!0),M=S(!1),V=$(()=>c.value),C=$(()=>{const i=Number(T.value);return isNaN(i)?0:Math.max(0,Math.min(i,l.value))}),m=$(()=>{const i=Number(w.value);return isNaN(i)?3:Math.max(.1,Math.min(i,l.value-C.value))}),v=$(()=>C.value+m.value),h=$(()=>W.value?s.value.find(i=>i.id===W.value):null),r=$(()=>s.value.filter(i=>i.endTime>=C.value&&i.startTime<=v.value)),x=$(()=>{const i=[];let e=[],d=0;for(const o of s.value)(o.startTime-d>1||e.length>8)&&e.length>0&&(i.push([...e]),e=[]),e.push(o),d=o.endTime;return e.length>0&&i.push(e),i}),k=i=>{if(W.value=i,i){const e=s.value.find(d=>d.id===i);e&&console.log('Selected word: "'.concat(e.text,'"'))}},g=i=>{i.forEach(e=>{const d=s.value.findIndex(o=>o.id===e.id);if(d!==-1){const o=s.value[d],D=o.startTime,b=o.endTime,_=e.startTime,E=e.endTime,F=o.syllables.map(I=>({text:I.text,startTime:Math.round(I.startTime*1e3),endTime:Math.round(I.endTime*1e3)})),y=le.fromAbsoluteSyllables(o.id,o.text,Math.round(D*1e3),Math.round(b*1e3),F);let a;const N=Math.abs(_-D)>.01,Y=Math.abs(E-b)>.01;N&&!Y?(a=y.moveWord(Math.round(_*1e3)),c.value&&console.log('MOVE: "'.concat(o.text,'" moved to ').concat(_.toFixed(2),"s"))):Y&&!N?(a=y.resizeWordEnd(Math.round(E*1e3)),c.value&&console.log('RESIZE: "'.concat(o.text,'" resized to ').concat(E.toFixed(2),"s"))):N&&Y?(a=y.moveWord(Math.round(_*1e3)).resizeWordEnd(Math.round(E*1e3)),c.value&&console.log('MOVE & RESIZE: "'.concat(o.text,'" moved and resized'))):a=y;const U=a.getWordData(),K=a.getAbsoluteSyllables();o.startTime=U.startTime/1e3,o.endTime=U.endTime/1e3,o.syllables=K.map(I=>({text:I.text,startTime:I.startTime/1e3,endTime:I.endTime/1e3}))}}),console.log("Words updated:",i.length)},L=i=>{k(i)},A=()=>{s.value=J(),l.value=de(),W.value=null,console.log("Timing data reset")};return X(()=>{A()}),(i,e)=>{const d=oe("router-link");return p(),f("div",ue,[t("div",ce,[t("div",me,[t("div",ve,[t("div",he,[t("nav",ge,[t("ol",be,[t("li",fe,[G(d,{to:"/compose",class:"text-decoration-none"},{default:ee(()=>[...e[5]||(e[5]=[t("i",{class:"bi bi-arrow-left"},null,-1),O(" Back to Projects ",-1)])]),_:1})]),e[6]||(e[6]=t("li",{class:"breadcrumb-item active"},"Word Timing Test",-1))])]),e[7]||(e[7]=t("h2",{class:"mb-1"},"Word Timing Editor Test",-1)),e[8]||(e[8]=t("p",{class:"mb-0 text-muted"},'Testing drag & drop word timing with "November" lyrics',-1))]),t("div",pe,[t("button",{class:"btn btn-primary btn-sm me-2",onClick:A},[...e[9]||(e[9]=[t("i",{class:"bi bi-arrow-clockwise"},null,-1),O(" Reset",-1)])]),t("button",{class:"btn btn-info btn-sm",onClick:e[0]||(e[0]=o=>c.value=!c.value)},[...e[10]||(e[10]=[t("i",{class:"bi bi-bug"},null,-1),O(" Debug",-1)])])])])])]),t("div",Te,[t("div",{class:B(["help-panel",{visible:M.value}]),onMouseenter:e[1]||(e[1]=o=>M.value=!0),onMouseleave:e[2]||(e[2]=o=>M.value=!1)},[...e[11]||(e[11]=[te('<div class="help-tab" data-v-340e981f><i class="bi bi-question-circle" data-v-340e981f></i><span data-v-340e981f>Help</span></div><div class="help-content" data-v-340e981f><h5 data-v-340e981f><i class="bi bi-info-circle" data-v-340e981f></i> Word Timing Editor</h5><ul class="help-list" data-v-340e981f><li data-v-340e981f><strong data-v-340e981f>Select:</strong> Click on any word box to select it</li><li data-v-340e981f><strong data-v-340e981f>Move:</strong> Drag a word box left/right to change its start time</li><li data-v-340e981f><strong data-v-340e981f>Resize:</strong> Drag the green handle on the right edge to change duration</li><li data-v-340e981f><strong data-v-340e981f>Syllables:</strong> Drag orange dividers within multi-syllable words</li><li data-v-340e981f><strong data-v-340e981f>View:</strong> Adjust the view window controls above to zoom in/out</li></ul></div>',2)])],34)]),t("div",we,[t("div",ye,[e[12]||(e[12]=t("h4",null,"Word Timing Editor",-1)),G(ie,{words:s.value,duration:l.value,"view-start":C.value,"view-end":v.value,"show-debug":V.value,"show-background":!0,"show-border":!0,"onUpdate:words":g,onSelectWord:L},null,8,["words","duration","view-start","view-end","show-debug"])]),t("div",xe,[t("div",_e,[t("div",We,[e[13]||(e[13]=t("label",{class:"form-label"},"View Window (seconds)",-1)),t("div",Ce,[t("div",Ne,[H(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>T.value=o),type:"number",class:"form-control form-control-sm",min:"0",max:l.value,step:"0.5",placeholder:"Start"},null,8,Ie),[[j,T.value,void 0,{number:!0}]])]),t("div",Me,[H(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>w.value=o),type:"number",class:"form-control form-control-sm",min:"0.1",max:l.value-C.value,step:"0.5",placeholder:"Duration"},null,8,Se),[[j,w.value,void 0,{number:!0}]])])])]),t("div",$e,[e[14]||(e[14]=t("label",{class:"form-label"},"Selected Word",-1)),t("div",ke,u(h.value?'"'.concat(h.value.text,'" (').concat(h.value.startTime.toFixed(1),"s - ").concat(h.value.endTime.toFixed(1),"s)"):"None"),1)]),t("div",De,[e[15]||(e[15]=t("label",{class:"form-label"},"Total Duration",-1)),t("div",Ee,u(l.value.toFixed(1))+" seconds ("+u(Math.floor(l.value/60))+":"+u(Math.floor(l.value%60).toString().padStart(2,"0"))+") ",1)])])]),t("div",Fe,[e[16]||(e[16]=t("h5",null,"Current Lyrics with Timing",-1)),t("div",Oe,[(p(!0),f(z,null,R(x.value,(o,D)=>(p(),f("div",{key:D,class:"lyrics-line mb-2"},[(p(!0),f(z,null,R(o,b=>(p(),f("span",{key:b.id,class:B(["lyrics-word me-1",{"selected-word":W.value===b.id}]),onClick:_=>k(b.id)},[O(u(b.text)+" ",1),t("small",Ae,"("+u(b.startTime.toFixed(1))+"s)",1)],10,Ve))),128))]))),128))])]),c.value?(p(),f("div",Pe,[e[18]||(e[18]=t("h5",null,"Debug Information",-1)),t("div",Le,[t("div",Ye,[t("h6",null,"Words in View ("+u(r.value.length)+")",1),t("div",ze,[(p(!0),f(z,null,R(r.value,o=>(p(),f("div",{key:o.id,class:"debug-word mb-1"},[t("strong",null,u(o.text),1),O(": "+u(o.startTime.toFixed(2))+"s - "+u(o.endTime.toFixed(2))+"s ",1),o.syllables.length>1?(p(),f("span",Re," ("+u(o.syllables.length)+" syllables) ",1)):q("",!0)]))),128))])]),t("div",Ue,[e[17]||(e[17]=t("h6",null,"Selected Word Details",-1)),t("div",Ge,[h.value?(p(),f("pre",Be,u(JSON.stringify(h.value,null,2)),1)):(p(),f("div",He,"No word selected"))])])])])):q("",!0)])])}}});const Ke=se(je,[["__scopeId","data-v-340e981f"]]);export{Ke as default};
//# sourceMappingURL=TestTimingView-5611dd51.js.map
